{"version":3,"file":"index-CyQ2XEvk.js","sources":["../src/composables/useModalManager.ts","../src/components/BModal/BModal.vue","../src/composables/useModal/index.ts"],"sourcesContent":["import {getSSRHandler, tryOnScopeDispose, unrefElement} from '@vueuse/core'\nimport {\n  type ComponentInternalInstance,\n  computed,\n  getCurrentInstance,\n  inject,\n  type Ref,\n  toValue,\n  watch,\n} from 'vue'\nimport {modalManagerKey} from '../utils/keys'\n\nconst modalOpenClassName = 'modal-open'\n\nexport const useSharedModalStack = () => {\n  const modalManagerPlugin = inject(modalManagerKey)\n\n  /**\n   * Removes an item from both the stack and registry\n   */\n  const dispose = (modal: Readonly<ComponentInternalInstance>): void => {\n    modalManagerPlugin?.removeStack(modal)\n    modalManagerPlugin?.removeRegistry(modal)\n  }\n\n  const updateHTMLAttrs = getSSRHandler('updateHTMLAttrs', (selector, attribute, value) => {\n    const el =\n      typeof selector === 'string'\n        ? window?.document.querySelector(selector)\n        : unrefElement(selector)\n    if (!el) return\n\n    if (attribute === 'class') {\n      el.classList.toggle(modalOpenClassName, value === modalOpenClassName)\n    } else {\n      el.setAttribute(attribute, value)\n    }\n  })\n\n  tryOnScopeDispose(() => {\n    if (modalManagerPlugin?.countStack.value === 0) {\n      updateHTMLAttrs('body', 'class', '')\n    }\n  })\n\n  watch(\n    () => modalManagerPlugin?.countStack.value,\n    (newValue) => {\n      if (newValue === undefined) return\n      updateHTMLAttrs('body', 'class', newValue > 0 ? modalOpenClassName : '')\n    }\n  )\n\n  return {\n    ...modalManagerPlugin,\n    dispose,\n  }\n}\n\nexport const useModalManager = (modalOpen: Readonly<Ref<boolean>>, initialValue: boolean) => {\n  const {pushRegistry, pushStack, removeStack, stack, dispose, countStack} = useSharedModalStack()\n\n  const currentModal = getCurrentInstance()\n\n  if (!currentModal || currentModal.type.__name !== 'BModal') {\n    throw new Error('useModalManager must only use in BModal component')\n  }\n\n  pushRegistry?.(currentModal)\n\n  tryOnScopeDispose(() => {\n    dispose(currentModal)\n  })\n\n  const setInStack = (newValue: boolean, oldValue: boolean) => {\n    if (newValue) {\n      pushStack?.(currentModal)\n    } else if (oldValue && !newValue) {\n      removeStack?.(currentModal)\n    }\n  }\n\n  // (initialValue, initialValue) is meant to always only ever trigger the first `if (newValue) {` block. The other block is skipped _always_\n  setInStack(initialValue, initialValue)\n\n  watch(modalOpen, setInStack)\n\n  return {\n    activePosition: computed(() =>\n      stack?.value.findIndex((el) => toValue(el.exposed?.id) === toValue(currentModal.exposed?.id))\n    ),\n    activeModalCount: countStack,\n    stackWithoutSelf: computed(\n      () =>\n        stack?.value.filter(\n          (el) => toValue(el.exposed?.id) !== toValue(currentModal.exposed?.id)\n        ) ?? []\n    ),\n  }\n}\n","<template>\n  <ConditionalTeleport :to=\"props.teleportTo\" :disabled=\"props.teleportDisabled\">\n    <Transition\n      v-if=\"renderRef || contentShowing\"\n      v-bind=\"transitionProps\"\n      :appear=\"modelValue || props.visible\"\n    >\n      <div\n        v-show=\"showRef && ((backdropReady && props.backdropFirst) || !props.backdropFirst)\"\n        :id=\"computedId\"\n        ref=\"_element\"\n        class=\"modal\"\n        :class=\"[\n          props.modalClass,\n          {\n            fade: !computedNoAnimation,\n            show: isVisible,\n            ...sharedClasses,\n          },\n        ]\"\n        role=\"dialog\"\n        :aria-labelledby=\"!props.noHeader ? `${computedId}-label` : undefined\"\n        :aria-describedby=\"`${computedId}-body`\"\n        tabindex=\"-1\"\n        v-bind=\"$attrs\"\n        :style=\"computedZIndex\"\n        style=\"display: block\"\n        @mousedown.left.self=\"hide('backdrop')\"\n      >\n        <div class=\"modal-dialog\" :class=\"modalDialogClasses\">\n          <div v-if=\"contentShowing\" class=\"modal-content\" :class=\"props.contentClass\">\n            <div\n              v-if=\"!props.noHeader\"\n              class=\"modal-header\"\n              :class=\"headerClasses\"\n              v-bind=\"props.headerAttrs\"\n            >\n              <slot name=\"header\" v-bind=\"sharedSlots\">\n                <component\n                  :is=\"props.titleTag\"\n                  :id=\"`${computedId}-label`\"\n                  class=\"modal-title\"\n                  :class=\"titleClasses\"\n                >\n                  <slot name=\"title\" v-bind=\"sharedSlots\">\n                    {{ props.title }}\n                  </slot>\n                </component>\n                <template v-if=\"!props.noHeaderClose\">\n                  <BButton\n                    v-if=\"hasHeaderCloseSlot\"\n                    ref=\"_closeButton\"\n                    v-bind=\"headerCloseAttrs\"\n                    @click=\"hide('close')\"\n                  >\n                    <slot name=\"header-close\" v-bind=\"sharedSlots\" />\n                  </BButton>\n                  <BCloseButton\n                    v-else\n                    ref=\"_closeButton\"\n                    :aria-label=\"props.headerCloseLabel\"\n                    v-bind=\"headerCloseAttrs\"\n                    @click=\"hide('close')\"\n                  />\n                </template>\n              </slot>\n            </div>\n            <div\n              :id=\"`${computedId}-body`\"\n              class=\"modal-body\"\n              :class=\"bodyClasses\"\n              v-bind=\"props.bodyAttrs\"\n            >\n              <slot v-bind=\"sharedSlots\">\n                {{ props.body }}\n              </slot>\n            </div>\n            <div v-if=\"!props.noFooter\" class=\"modal-footer\" :class=\"footerClasses\">\n              <slot name=\"footer\" v-bind=\"sharedSlots\">\n                <slot name=\"cancel\" v-bind=\"sharedSlots\">\n                  <BButton\n                    v-if=\"!props.okOnly\"\n                    ref=\"_cancelButton\"\n                    :disabled=\"disableCancel\"\n                    :size=\"props.buttonSize\"\n                    :variant=\"props.cancelVariant\"\n                    :class=\"props.cancelClass\"\n                    @click=\"hide('cancel')\"\n                  >\n                    {{ props.cancelTitle }}\n                  </BButton>\n                </slot>\n                <slot name=\"ok\" v-bind=\"sharedSlots\">\n                  <BButton\n                    ref=\"_okButton\"\n                    :disabled=\"disableOk\"\n                    :size=\"props.buttonSize\"\n                    :variant=\"props.okVariant\"\n                    :class=\"props.okClass\"\n                    @click=\"hide('ok')\"\n                  >\n                    {{ props.okTitle }}\n                  </BButton>\n                </slot>\n              </slot>\n            </div>\n          </div>\n        </div>\n        <div\n          v-if=\"needsFallback\"\n          ref=\"_fallbackFocusElement\"\n          :class=\"fallbackClassSelector\"\n          tabindex=\"0\"\n          style=\"width: 0; height: 0; overflow: hidden\"\n        />\n      </div>\n    </Transition>\n    <slot v-if=\"!props.noBackdrop\" name=\"backdrop\" v-bind=\"sharedSlots\">\n      <Transition v-if=\"renderBackdropRef\" v-bind=\"backdropTransitionProps\">\n        <div\n          v-show=\"showRef || (isLeaving && props.backdropFirst && !computedNoAnimation)\"\n          class=\"modal-backdrop\"\n          :style=\"computedZIndexBackdrop\"\n          :class=\"{\n            fade: !computedNoAnimation,\n            show: backdropVisible || computedNoAnimation,\n            ...sharedClasses,\n          }\"\n          @click=\"hide('backdrop')\"\n        />\n      </Transition>\n    </slot>\n  </ConditionalTeleport>\n</template>\n\n<script setup lang=\"ts\">\nimport {onKeyStroke, unrefElement} from '@vueuse/core'\nimport {useActivatedFocusTrap} from '../../composables/useActivatedFocusTrap'\nimport {\n  computed,\n  type CSSProperties,\n  type EmitFn,\n  nextTick,\n  onMounted,\n  ref,\n  useTemplateRef,\n  watch,\n} from 'vue'\nimport type {BModalProps} from '../../types/ComponentProps'\nimport type {BModalEmits} from '../../types/ComponentEmits'\nimport type {BModalSlots, BModalSlotsData} from '../../types/ComponentSlots'\n\nimport BButton from '../BButton/BButton.vue'\nimport BCloseButton from '../BButton/BCloseButton.vue'\nimport {useDefaults} from '../../composables/useDefaults'\nimport {useId} from '../../composables/useId'\nimport {useSafeScrollLock} from '../../composables/useSafeScrollLock'\nimport {getModalZIndex, isEmptySlot} from '../../utils/dom'\nimport {useColorVariantClasses} from '../../composables/useColorVariantClasses'\nimport {useModalManager} from '../../composables/useModalManager'\nimport {useShowHide} from '../../composables/useShowHide'\nimport ConditionalTeleport from '../ConditionalTeleport.vue'\nimport {getElement} from '../../utils/getElement'\n\ndefineOptions({\n  inheritAttrs: false,\n})\n\nconst _props = withDefaults(defineProps<Omit<BModalProps, 'modelValue'>>(), {\n  focus: undefined,\n  backdropFirst: false,\n  body: undefined,\n  bodyBgVariant: null,\n  bodyAttrs: undefined,\n  bodyClass: null,\n  bodyScrolling: false,\n  bodyTextVariant: null,\n  bodyVariant: null,\n  busy: false,\n  buttonSize: 'md',\n  cancelClass: undefined,\n  cancelDisabled: false,\n  cancelTitle: 'Cancel',\n  cancelVariant: 'secondary',\n  centered: false,\n  contentClass: undefined,\n  dialogClass: undefined,\n  footerBgVariant: null,\n  footerBorderVariant: null,\n  footerClass: undefined,\n  footerTextVariant: null,\n  footerVariant: null,\n  fullscreen: false,\n  headerAttrs: undefined,\n  headerBgVariant: null,\n  headerBorderVariant: null,\n  headerClass: undefined,\n  headerCloseClass: undefined,\n  headerCloseLabel: 'Close',\n  headerCloseVariant: 'secondary',\n  headerTextVariant: null,\n  headerVariant: null,\n  noFooter: false,\n  noHeader: false,\n  noHeaderClose: false,\n  id: undefined,\n  initialAnimation: false,\n  lazy: false,\n  modalClass: undefined,\n  noBackdrop: false,\n  noCloseOnBackdrop: false,\n  noCloseOnEsc: false,\n  noFade: false,\n  noTrap: false,\n  okClass: undefined,\n  okDisabled: false,\n  okOnly: false,\n  okTitle: 'OK',\n  okVariant: 'primary',\n  unmountLazy: false,\n  scrollable: false,\n  size: 'md',\n  teleportDisabled: false,\n  teleportTo: 'body',\n  title: undefined,\n  titleClass: undefined,\n  titleVisuallyHidden: false,\n  titleTag: 'h5',\n  show: false,\n  transProps: undefined,\n  visible: false,\n})\nconst props = useDefaults(_props, 'BModal')\nconst emit = defineEmits<BModalEmits>()\nconst slots = defineSlots<BModalSlots>()\n\nconst computedId = useId(() => props.id, 'modal')\n// Note: passive: true will sync an internal ref... This is required for useModalManager to exit,\n// Since the modelValue that's passed from that composable is not reactive, this internal ref _is_ and thus it will trigger closing the modal\nconst modelValue = defineModel<Exclude<BModalProps['modelValue'], undefined>>({default: false})\n\nconst element = useTemplateRef<HTMLElement | null>('_element')\nconst fallbackFocusElement = useTemplateRef<HTMLElement | null>('_fallbackFocusElement')\nconst okButton = useTemplateRef<HTMLElement | null>('_okButton')\nconst cancelButton = useTemplateRef<HTMLElement | null>('_cancelButton')\nconst closeButton = useTemplateRef<HTMLElement | null>('_closeButton')\n\nconst pickFocusItem = () => {\n  if (props.focus && typeof props.focus !== 'boolean') {\n    if (props.focus === 'ok') {\n      return okButton\n    } else if (props.focus === 'close') {\n      return closeButton\n    } else if (props.focus === 'cancel') {\n      return cancelButton\n    }\n    return getElement(props.focus, element.value ?? undefined) ?? element.value\n  }\n  return element\n}\n\nlet activeElement: HTMLElement | null = null\nconst onAfterEnter = () => {\n  if (props.noTrap && props.focus !== false) {\n    activeElement = document.activeElement as HTMLElement\n    if (activeElement === element.value) {\n      activeElement = null\n    }\n    const el = unrefElement(pickFocusItem())\n    if (!el) return\n    el?.focus()\n    if (\n      el.tagName &&\n      el.tagName.toLowerCase() === 'input' &&\n      typeof (el as HTMLInputElement).select === 'function'\n    ) {\n      ;(el as HTMLInputElement).select()\n    }\n  }\n}\n\nconst onAfterLeave = () => {\n  if (props.noTrap && props.focus !== false && activeElement) {\n    activeElement?.focus()\n    activeElement = null\n  }\n}\n\nconst {\n  showRef,\n  renderRef,\n  renderBackdropRef,\n  hide,\n  show,\n  toggle,\n  computedNoAnimation,\n  transitionProps,\n  backdropTransitionProps,\n  isLeaving,\n  isVisible,\n  trapActive,\n  contentShowing,\n  backdropReady,\n  backdropVisible,\n} = useShowHide(modelValue, props, emit as EmitFn, element, computedId, {\n  // addShowClass: false,\n  transitionProps: {\n    onAfterEnter,\n    onAfterLeave,\n  },\n})\n\nconst fallbackClassSelector = 'modal-fallback-focus'\nconst {needsFallback} = useActivatedFocusTrap({\n  element,\n  isActive: trapActive,\n  noTrap: () => props.noTrap,\n  fallbackFocus: {\n    ref: fallbackFocusElement,\n    classSelector: fallbackClassSelector,\n  },\n  focus: () => (props.focus === false ? false : (unrefElement(pickFocusItem()) ?? undefined)),\n  // () => (typeof focus === 'boolean' ? focus : (unrefElement(focus) ?? undefined)),\n})\n\nonKeyStroke(\n  'Escape',\n  () => {\n    hide('esc')\n  },\n  {target: element}\n)\nuseSafeScrollLock(showRef, () => props.bodyScrolling)\n\nconst hasHeaderCloseSlot = computed(() => !isEmptySlot(slots['header-close']))\n\nconst modalDialogClasses = computed(() => [\n  props.dialogClass,\n  {\n    'modal-fullscreen': props.fullscreen === true,\n    [`modal-fullscreen-${props.fullscreen}-down`]: typeof props.fullscreen === 'string',\n    [`modal-${props.size}`]: props.size !== 'md',\n    'modal-dialog-centered': props.centered,\n    'modal-dialog-scrollable': props.scrollable,\n  },\n])\n\nconst bodyColorClasses = useColorVariantClasses(() => ({\n  bgVariant: props.bodyBgVariant,\n  textVariant: props.bodyTextVariant,\n  variant: props.bodyVariant,\n}))\nconst bodyClasses = computed(() => [props.bodyClass, bodyColorClasses.value])\n\nconst headerColorClasses = useColorVariantClasses(() => ({\n  bgVariant: props.headerBgVariant,\n  textVariant: props.headerTextVariant,\n  variant: props.headerVariant,\n  borderVariant: props.headerBorderVariant,\n}))\nconst headerClasses = computed(() => [props.headerClass, headerColorClasses.value])\n\nconst headerCloseAttrs = computed(() => ({\n  variant: hasHeaderCloseSlot.value ? props.headerCloseVariant : undefined,\n  class: props.headerCloseClass,\n}))\n\nconst footerColorClasses = useColorVariantClasses(() => ({\n  bgVariant: props.footerBgVariant,\n  textVariant: props.footerTextVariant,\n  variant: props.footerVariant,\n  borderVariant: props.footerBorderVariant,\n}))\nconst footerClasses = computed(() => [props.footerClass, footerColorClasses.value])\n\nconst titleClasses = computed(() => [\n  props.titleClass,\n  {\n    ['visually-hidden']: props.titleVisuallyHidden,\n  },\n])\n\nconst disableCancel = computed(() => props.cancelDisabled || props.busy)\nconst disableOk = computed(() => props.okDisabled || props.busy)\n\nconst {activePosition, activeModalCount, stackWithoutSelf} = useModalManager(\n  showRef,\n  modelValue.value\n)\n\nconst sharedClasses = computed(() => ({\n  [`stack-position-${activePosition?.value ?? 0}`]: true,\n  [`stack-inverse-position-${(activeModalCount?.value ?? 1) - 1 - (activePosition?.value ?? 0)}`]: true,\n}))\n\nwatch(stackWithoutSelf, (newValue, oldValue) => {\n  if (newValue.length > oldValue.length && showRef.value === true && props.noStacking === true)\n    hide()\n})\n\nconst defaultModalDialogZIndex = ref(\n  getModalZIndex(element.value ?? (typeof document !== 'undefined' ? document.body : undefined))\n)\n\nonMounted(() => {\n  watch(\n    renderRef,\n    (v) => {\n      if (!v) return\n      nextTick(() => {\n        if (!element.value) return\n        defaultModalDialogZIndex.value = getModalZIndex(element.value)\n      })\n    },\n    {immediate: true}\n  )\n})\n\nconst computedZIndexNumber = computed<number>(() =>\n  // Make sure that newly opened modals have a higher z-index than currently active ones.\n  // All active modals have a z-index of ('defaultZIndex' - 'stackSize' - 'positionInStack').\n  //\n  // This means inactive modals will already be higher than active ones when opened.\n\n  showRef.value || isLeaving.value\n    ? // Just for reference there is a single frame in which the modal is not active but still has a higher z-index than the active ones due to _when_ it calculates its position. It's a small visual effect\n      defaultModalDialogZIndex.value -\n      ((activeModalCount?.value ?? 0) * 2 - (activePosition?.value ?? 0) * 2)\n    : defaultModalDialogZIndex.value\n)\nconst computedZIndex = computed<CSSProperties>(() => ({\n  'z-index': computedZIndexNumber.value,\n  '--b-position': activePosition?.value ?? 0,\n  '--b-inverse-position': (activeModalCount?.value ?? 1) - 1 - (activePosition?.value ?? 0),\n  '--b-count': activeModalCount?.value ?? 0,\n}))\nconst computedZIndexBackdrop = computed<CSSProperties>(() => ({\n  'z-index': computedZIndexNumber.value - 1,\n  '--b-position': activePosition?.value ?? 0,\n  '--b-inverse-position': (activeModalCount?.value ?? 1) - 1 - (activePosition?.value ?? 0),\n  '--b-count': activeModalCount?.value ?? 0,\n}))\n\nconst sharedSlots = computed<BModalSlotsData>(() => ({\n  id: computedId.value,\n  cancel: () => {\n    hide('cancel')\n  },\n  close: () => {\n    hide('close')\n  },\n  hide,\n  show,\n  toggle,\n  ok: () => {\n    hide('ok')\n  },\n  active: showRef.value,\n  visible: showRef.value,\n}))\n\ndefineExpose({\n  hide,\n  id: computedId,\n  show,\n  toggle,\n  visible: showRef,\n})\n</script>\n","import {\n  type ComponentInternalInstance,\n  computed,\n  getCurrentInstance,\n  inject,\n  isReadonly,\n  isRef,\n  markRaw,\n  onScopeDispose,\n  type Ref,\n  toRef,\n  toValue,\n  watch,\n} from 'vue'\nimport {useSharedModalStack} from '../useModalManager'\n\nimport {orchestratorRegistryKey} from '../../utils/keys'\nimport type {\n  ControllerKey,\n  ModalOrchestratorArrayValue,\n  ModalOrchestratorCreateParam,\n  ModalOrchestratorParam,\n  OrchestratorCreateOptions,\n  PromiseWithComponent,\n} from '../../types/ComponentOrchestratorTypes'\nimport {buildPromise} from '../orchestratorShared'\nimport {BModal} from '../../components'\n\nexport const useModal = () => {\n  const orchestratorRegistry = inject(orchestratorRegistryKey)\n  if (!orchestratorRegistry) {\n    throw Error(\n      'useModal() must be called within setup(), and BApp, useRegistry or plugin must be installed/provided.'\n    )\n  }\n  const {store, _isOrchestratorInstalled} = orchestratorRegistry\n\n  /**\n   * @returns {PromiseWithComponent}  Returns a promise object with methods to control the modal (show, hide, toggle, get, set, destroy)\n   */\n  const create = (\n    obj: ModalOrchestratorCreateParam = {},\n    options: OrchestratorCreateOptions = {}\n  ): PromiseWithComponent<typeof BModal, ModalOrchestratorParam> => {\n    if (!_isOrchestratorInstalled.value) {\n      throw new Error('BApp or BOrchestrator component must be mounted to use the modal controller')\n    }\n\n    const resolvedProps = toRef(obj)\n    const _self = resolvedProps.value?.id || Symbol('Modals controller')\n\n    const promise = buildPromise<\n      typeof BModal,\n      ModalOrchestratorParam,\n      ModalOrchestratorArrayValue\n    >(_self, store as Ref<ModalOrchestratorArrayValue[]>)\n\n    promise.stop = watch(\n      resolvedProps,\n      (_newValue) => {\n        const newValue = {...toValue(_newValue)}\n        const previousIndex = store.value.findIndex((el) => el._self === _self)\n        const previous =\n          previousIndex === -1 ? {_component: markRaw(BModal)} : store.value[previousIndex]\n        const v = {\n          type: 'modal',\n          _self,\n          position: 'modal',\n          ...previous,\n          options,\n          promise,\n        } as ModalOrchestratorArrayValue\n\n        for (const key in newValue) {\n          if (key.startsWith('on')) {\n            v[key as keyof ModalOrchestratorCreateParam] =\n              newValue[key as keyof ModalOrchestratorCreateParam]\n          } else if (key === 'component' && newValue.component) {\n            v._component = markRaw(newValue.component)\n          } else if (key === 'slots' && newValue.slots) {\n            v.slots = markRaw(newValue.slots)\n          } else {\n            v[key as keyof ModalOrchestratorCreateParam] = toValue(\n              newValue[key as keyof ModalOrchestratorCreateParam]\n            )\n          }\n        }\n        v.modelValue = v.modelValue ?? false\n        v['onUpdate:modelValue'] = (val: boolean) => {\n          newValue['onUpdate:modelValue']?.(val)\n          const {modelValue} = toValue(obj)\n          if (isRef(obj) && !isRef(modelValue)) obj.value.modelValue = val\n          if (isRef(modelValue) && !isReadonly(modelValue)) {\n            ;(modelValue as Ref<ModalOrchestratorArrayValue['modelValue']>).value = val\n          }\n          const modal = store.value.find((el) => el._self === _self)\n          if (modal) {\n            modal.modelValue = val\n          }\n        }\n\n        if (previousIndex === -1) {\n          store.value.push(v)\n        } else {\n          store.value.splice(previousIndex, 1, v)\n        }\n      },\n      {\n        immediate: true,\n        deep: true,\n      }\n    )\n    onScopeDispose(() => {\n      const modal = store.value.find((el) => el._self === _self)\n      if (modal) {\n        modal.promise.value.destroy?.()\n      }\n    }, true)\n    return promise.value\n  }\n\n  const {lastStack, stack, registry} = useSharedModalStack()\n  /**\n   * Show a modal\n   * @param id - The id of the modal to show\n   */\n  const show = (id?: ControllerKey) => {\n    if (id === undefined) {\n      if (lastStack?.value) {\n        lastStack?.value.exposed?.show()\n      }\n    } else {\n      const stackModal = stack?.value.find((modal) => modal.exposed?.id === id)\n      if (stackModal) {\n        stackModal.exposed?.show()\n        return\n      }\n      const modal = store.value.find((el) => el._self === id)\n      if (modal) {\n        modal.modelValue = true\n        modal['onUpdate:modelValue']?.(true)\n      } else {\n        stack?.value.forEach((modal) => {\n          if (modal.exposed?.id === id) {\n            modal.exposed?.show()\n          }\n        })\n      }\n    }\n  }\n\n  /**\n   * Hide a modal\n   * @param trigger - The trigger to hide the modal\n   * @param id - The id of the modal to hide\n   */\n  const hide = (trigger?: string, id?: ControllerKey) => {\n    if (id === undefined) {\n      if (lastStack?.value) {\n        lastStack?.value.exposed?.hide(trigger)\n      }\n    } else {\n      const stackModal = stack?.value.find((modal) => modal.exposed?.id === id)\n      if (stackModal) {\n        stackModal.exposed?.hide(trigger)\n        return\n      }\n      const modal = store.value.find((el) => el._self === id)\n      if (modal) {\n        modal.modelValue = false\n        modal['onUpdate:modelValue']?.(false)\n      } else {\n        stack?.value.forEach((modal) => {\n          if (modal.exposed?.id === id) {\n            modal.exposed?.hide(trigger, true)\n          }\n        })\n      }\n    }\n  }\n\n  /**\n   * Hide all modals\n   * @param trigger - The trigger to hide all modals\n   */\n  const hideAll = (trigger?: string) => {\n    stack?.value.forEach((modal) => {\n      modal.exposed?.hide(trigger, true)\n    })\n  }\n\n  const get = (id: ControllerKey) => {\n    const modal = store.value.find((el) => el._self === id)\n    if (modal) {\n      return {\n        modal,\n        show() {\n          modal?.promise.value.show()\n        },\n        hide(trigger?: string) {\n          modal?.promise.value.hide(trigger)\n        },\n      }\n    }\n    if (registry?.value) {\n      for (const [, modal] of registry?.value.entries() ?? []) {\n        if (toValue(modal.exposed?.id) === id) {\n          return {\n            modal,\n            show() {\n              modal.exposed?.show()\n            },\n            hide(trigger?: string) {\n              modal.exposed?.hide(trigger, true)\n            },\n          }\n        }\n      }\n    }\n    return null\n  }\n\n  const instance = getCurrentInstance()\n  const current = () => {\n    const findBModal = (component: ComponentInternalInstance): ComponentInternalInstance | null => {\n      if (!component.parent) {\n        return null\n      }\n      if (component.parent.type === BModal) {\n        return component.parent\n      }\n      return findBModal(component.parent)\n    }\n    if (!instance) {\n      return null\n    }\n    const modalComponent = computed(() => findBModal(instance))\n    const modal = computed(() => modalComponent.value?.proxy)\n    return {\n      show() {\n        modalComponent.value?.exposed?.show()\n      },\n      hide(trigger?: string) {\n        modalComponent.value?.exposed?.hide(trigger, true)\n      },\n      modal,\n    }\n  }\n\n  return {\n    show,\n    hide,\n    hideAll,\n    get,\n    current,\n    create,\n    _isOrchestratorInstalled,\n    store,\n    // Todo: Supports listening events globally in the future\n  }\n}\n\n/**\n * @deprecated use useModal() instead.\n * @returns {ReturnType<typeof useModal>} The modal controller\n */\nexport const useModalController = useModal\n"],"names":["modalOpenClassName","useSharedModalStack","modalManagerPlugin","inject","modalManagerKey","updateHTMLAttrs","getSSRHandler","selector","attribute","value","el","window","document","querySelector","unrefElement","classList","toggle","setAttribute","tryOnScopeDispose","countStack","watch","newValue","dispose","modal","removeStack","removeRegistry","fallbackClassSelector","_props","__props","props","useDefaults","emit","__emit","slots","_useSlots","computedId","useId","id","modelValue","_useModel","element","useTemplateRef","fallbackFocusElement","okButton","cancelButton","closeButton","pickFocusItem","focus","getElement","activeElement","showRef","renderRef","renderBackdropRef","hide","show","computedNoAnimation","transitionProps","backdropTransitionProps","isLeaving","isVisible","trapActive","contentShowing","backdropReady","backdropVisible","useShowHide","onAfterEnter","noTrap","tagName","toLowerCase","select","onAfterLeave","needsFallback","useActivatedFocusTrap","isActive","fallbackFocus","ref","classSelector","onKeyStroke","target","useSafeScrollLock","bodyScrolling","hasHeaderCloseSlot","computed","isEmptySlot","modalDialogClasses","dialogClass","fullscreen","size","centered","scrollable","bodyColorClasses","useColorVariantClasses","bgVariant","bodyBgVariant","textVariant","bodyTextVariant","variant","bodyVariant","bodyClasses","bodyClass","headerColorClasses","headerBgVariant","headerTextVariant","headerVariant","borderVariant","headerBorderVariant","headerClasses","headerClass","headerCloseAttrs","headerCloseVariant","class","headerCloseClass","footerColorClasses","footerBgVariant","footerTextVariant","footerVariant","footerBorderVariant","footerClasses","footerClass","titleClasses","titleClass","titleVisuallyHidden","disableCancel","cancelDisabled","busy","disableOk","okDisabled","activePosition","activeModalCount","stackWithoutSelf","modalOpen","initialValue","pushRegistry","pushStack","stack","currentModal","getCurrentInstance","type","__name","Error","setInStack","oldValue","findIndex","toValue","exposed","filter","useModalManager","sharedClasses","length","noStacking","defaultModalDialogZIndex","getModalZIndex","body","onMounted","v","nextTick","immediate","computedZIndexNumber","computedZIndex","computedZIndexBackdrop","sharedSlots","cancel","close","ok","active","visible","__expose","_createBlock","ConditionalTeleport","to","_unref","teleportTo","disabled","teleportDisabled","_Transition","_mergeProps","key","appear","_withDirectives","_createElementVNode","modalClass","role","noHeader","tabindex","$attrs","style","display","onMousedown","_normalizeClass","_createElementBlock","contentClass","_openBlock","headerAttrs","_renderSlot","_ctx","$slots","_normalizeProps","_guardReactiveProps","_resolveDynamicComponent","titleTag","_createTextVNode","_toDisplayString","title","noHeaderClose","_Fragment","BButton","onClick","BCloseButton","headerCloseLabel","bodyAttrs","noFooter","okOnly","buttonSize","cancelVariant","cancelClass","cancelTitle","_createVNode","okVariant","okClass","okTitle","width","height","overflow","backdropFirst","noBackdrop","_vShow","useModal","orchestratorRegistry","orchestratorRegistryKey","store","_isOrchestratorInstalled","lastStack","registry","instance","stackModal","find","_self","forEach","trigger","hideAll","get","promise","entries","current","findBModal","component","parent","BModal","modalComponent","proxy","create","obj","options","resolvedProps","toRef","Symbol","buildPromise","stop","_newValue","previousIndex","previous","_component","markRaw","position","startsWith","val","isRef","isReadonly","push","splice","deep","onScopeDispose","destroy","useModalController"],"mappings":"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"}